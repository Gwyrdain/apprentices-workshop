{"filter":false,"title":"area.rb","tooltip":"/app/models/area.rb","undoManager":{"mark":100,"position":100,"stack":[[{"start":{"row":442,"column":6},"end":{"row":442,"column":7},"action":"insert","lines":["="],"id":6770}],[{"start":{"row":442,"column":7},"end":{"row":442,"column":8},"action":"insert","lines":[" "],"id":6771}],[{"start":{"row":442,"column":8},"end":{"row":442,"column":9},"action":"insert","lines":["e"],"id":6772}],[{"start":{"row":442,"column":9},"end":{"row":442,"column":10},"action":"insert","lines":["x"],"id":6773}],[{"start":{"row":442,"column":8},"end":{"row":442,"column":10},"action":"remove","lines":["ex"],"id":6774},{"start":{"row":442,"column":8},"end":{"row":442,"column":17},"action":"insert","lines":["exit_data"]}],[{"start":{"row":442,"column":17},"end":{"row":442,"column":18},"action":"insert","lines":["."],"id":6775}],[{"start":{"row":442,"column":18},"end":{"row":442,"column":19},"action":"insert","lines":["m"],"id":6776}],[{"start":{"row":442,"column":19},"end":{"row":442,"column":20},"action":"insert","lines":["a"],"id":6777}],[{"start":{"row":442,"column":20},"end":{"row":442,"column":21},"action":"insert","lines":["t"],"id":6778}],[{"start":{"row":442,"column":18},"end":{"row":442,"column":21},"action":"remove","lines":["mat"],"id":6779},{"start":{"row":442,"column":18},"end":{"row":442,"column":23},"action":"insert","lines":["match"]}],[{"start":{"row":442,"column":23},"end":{"row":442,"column":25},"action":"insert","lines":["()"],"id":6780}],[{"start":{"row":442,"column":24},"end":{"row":442,"column":25},"action":"insert","lines":["/"],"id":6781}],[{"start":{"row":442,"column":25},"end":{"row":442,"column":26},"action":"insert","lines":["/"],"id":6784}],[{"start":{"row":442,"column":25},"end":{"row":442,"column":26},"action":"remove","lines":["/"],"id":6785}],[{"start":{"row":442,"column":25},"end":{"row":442,"column":35},"action":"insert","lines":["\\d\\n[^~]*~"],"id":6786}],[{"start":{"row":442,"column":35},"end":{"row":442,"column":36},"action":"insert","lines":["/"],"id":6787}],[{"start":{"row":442,"column":34},"end":{"row":442,"column":35},"action":"insert","lines":[")"],"id":6788}],[{"start":{"row":442,"column":29},"end":{"row":442,"column":30},"action":"insert","lines":["("],"id":6789}],[{"start":{"row":443,"column":0},"end":{"row":443,"column":37},"action":"insert","lines":["exit_info[\"description\"] = m[2].strip"],"id":6790}],[{"start":{"row":443,"column":0},"end":{"row":443,"column":2},"action":"insert","lines":["  "],"id":6791}],[{"start":{"row":443,"column":39},"end":{"row":444,"column":0},"action":"insert","lines":["",""],"id":6792},{"start":{"row":444,"column":0},"end":{"row":444,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":443,"column":2},"end":{"row":443,"column":4},"action":"insert","lines":["  "],"id":6793}],[{"start":{"row":442,"column":39},"end":{"row":443,"column":0},"action":"insert","lines":["",""],"id":6794},{"start":{"row":443,"column":0},"end":{"row":443,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":443,"column":4},"end":{"row":443,"column":5},"action":"insert","lines":["o"],"id":6795}],[{"start":{"row":443,"column":5},"end":{"row":443,"column":6},"action":"insert","lines":["o"],"id":6796}],[{"start":{"row":443,"column":6},"end":{"row":443,"column":7},"action":"insert","lines":["f"],"id":6797}],[{"start":{"row":443,"column":6},"end":{"row":443,"column":7},"action":"remove","lines":["f"],"id":6798}],[{"start":{"row":443,"column":5},"end":{"row":443,"column":6},"action":"remove","lines":["o"],"id":6799}],[{"start":{"row":443,"column":4},"end":{"row":443,"column":5},"action":"remove","lines":["o"],"id":6800}],[{"start":{"row":443,"column":4},"end":{"row":443,"column":5},"action":"insert","lines":["i"],"id":6801}],[{"start":{"row":443,"column":5},"end":{"row":443,"column":6},"action":"insert","lines":["f"],"id":6802}],[{"start":{"row":443,"column":6},"end":{"row":443,"column":7},"action":"insert","lines":[" "],"id":6803}],[{"start":{"row":443,"column":7},"end":{"row":443,"column":8},"action":"insert","lines":["m"],"id":6804}],[{"start":{"row":443,"column":7},"end":{"row":443,"column":8},"action":"remove","lines":["m"],"id":6805},{"start":{"row":443,"column":7},"end":{"row":444,"column":4},"action":"insert","lines":["my_area","    "]}],[{"start":{"row":444,"column":2},"end":{"row":444,"column":4},"action":"remove","lines":["  "],"id":6806}],[{"start":{"row":444,"column":0},"end":{"row":444,"column":2},"action":"remove","lines":["  "],"id":6807}],[{"start":{"row":443,"column":14},"end":{"row":444,"column":0},"action":"remove","lines":["",""],"id":6808}],[{"start":{"row":443,"column":13},"end":{"row":443,"column":14},"action":"remove","lines":["a"],"id":6809}],[{"start":{"row":443,"column":12},"end":{"row":443,"column":13},"action":"remove","lines":["e"],"id":6810}],[{"start":{"row":443,"column":11},"end":{"row":443,"column":12},"action":"remove","lines":["r"],"id":6811}],[{"start":{"row":443,"column":10},"end":{"row":443,"column":11},"action":"remove","lines":["a"],"id":6812}],[{"start":{"row":443,"column":9},"end":{"row":443,"column":10},"action":"remove","lines":["_"],"id":6813}],[{"start":{"row":443,"column":8},"end":{"row":443,"column":9},"action":"remove","lines":["y"],"id":6814}],[{"start":{"row":444,"column":4},"end":{"row":444,"column":6},"action":"insert","lines":["  "],"id":6815}],[{"start":{"row":445,"column":2},"end":{"row":446,"column":0},"action":"insert","lines":["",""],"id":6816},{"start":{"row":446,"column":0},"end":{"row":446,"column":2},"action":"insert","lines":["  "]}],[{"start":{"row":445,"column":2},"end":{"row":445,"column":4},"action":"insert","lines":["  "],"id":6817}],[{"start":{"row":445,"column":4},"end":{"row":445,"column":5},"action":"insert","lines":["e"],"id":6818}],[{"start":{"row":445,"column":5},"end":{"row":445,"column":6},"action":"insert","lines":["l"],"id":6819}],[{"start":{"row":445,"column":6},"end":{"row":445,"column":7},"action":"insert","lines":["s"],"id":6820}],[{"start":{"row":445,"column":7},"end":{"row":445,"column":8},"action":"insert","lines":["e"],"id":6821}],[{"start":{"row":445,"column":4},"end":{"row":445,"column":8},"action":"remove","lines":["else"],"id":6822},{"start":{"row":445,"column":4},"end":{"row":445,"column":8},"action":"insert","lines":["else"]}],[{"start":{"row":445,"column":8},"end":{"row":446,"column":0},"action":"insert","lines":["",""],"id":6823},{"start":{"row":446,"column":0},"end":{"row":446,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":446,"column":6},"end":{"row":446,"column":7},"action":"insert","lines":["e"],"id":6824}],[{"start":{"row":446,"column":7},"end":{"row":446,"column":8},"action":"insert","lines":["n"],"id":6825}],[{"start":{"row":446,"column":8},"end":{"row":446,"column":9},"action":"insert","lines":["s"],"id":6826}],[{"start":{"row":446,"column":8},"end":{"row":446,"column":9},"action":"remove","lines":["s"],"id":6827}],[{"start":{"row":446,"column":8},"end":{"row":446,"column":9},"action":"insert","lines":["d"],"id":6828},{"start":{"row":446,"column":4},"end":{"row":446,"column":6},"action":"remove","lines":["  "]}],[{"start":{"row":445,"column":8},"end":{"row":446,"column":0},"action":"insert","lines":["",""],"id":6829},{"start":{"row":446,"column":0},"end":{"row":446,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":446,"column":6},"end":{"row":446,"column":43},"action":"insert","lines":["exit_info[\"description\"] = m[2].strip"],"id":6830}],[{"start":{"row":446,"column":33},"end":{"row":446,"column":43},"action":"remove","lines":["m[2].strip"],"id":6831},{"start":{"row":446,"column":33},"end":{"row":446,"column":34},"action":"insert","lines":["\""]}],[{"start":{"row":446,"column":34},"end":{"row":446,"column":35},"action":"insert","lines":["e"],"id":6832}],[{"start":{"row":446,"column":35},"end":{"row":446,"column":36},"action":"insert","lines":["r"],"id":6833}],[{"start":{"row":446,"column":36},"end":{"row":446,"column":37},"action":"insert","lines":["r"],"id":6834}],[{"start":{"row":446,"column":37},"end":{"row":446,"column":38},"action":"insert","lines":["o"],"id":6835}],[{"start":{"row":446,"column":38},"end":{"row":446,"column":39},"action":"insert","lines":["r"],"id":6836}],[{"start":{"row":446,"column":39},"end":{"row":446,"column":40},"action":"insert","lines":["\""],"id":6837}],[{"start":{"row":446,"column":39},"end":{"row":446,"column":40},"action":"insert","lines":["<"],"id":6838}],[{"start":{"row":446,"column":40},"end":{"row":446,"column":41},"action":"insert","lines":["b"],"id":6839}],[{"start":{"row":446,"column":41},"end":{"row":446,"column":42},"action":"insert","lines":[">"],"id":6840}],[{"start":{"row":446,"column":41},"end":{"row":446,"column":42},"action":"insert","lines":["/"],"id":6841}],[{"start":{"row":446,"column":41},"end":{"row":446,"column":42},"action":"remove","lines":["/"],"id":6842}],[{"start":{"row":446,"column":40},"end":{"row":446,"column":41},"action":"insert","lines":["/"],"id":6843}],[{"start":{"row":446,"column":34},"end":{"row":446,"column":35},"action":"insert","lines":["<"],"id":6844}],[{"start":{"row":446,"column":35},"end":{"row":446,"column":36},"action":"insert","lines":["b"],"id":6845}],[{"start":{"row":446,"column":36},"end":{"row":446,"column":37},"action":"insert","lines":[">"],"id":6846}],[{"start":{"row":444,"column":35},"end":{"row":444,"column":36},"action":"remove","lines":["2"],"id":6847},{"start":{"row":444,"column":35},"end":{"row":444,"column":36},"action":"insert","lines":["1"]}],[{"start":{"row":445,"column":0},"end":{"row":447,"column":7},"action":"remove","lines":["    else","      exit_info[\"description\"] = \"<b>error</b>\"","    end"],"id":6848}],[{"start":{"row":444,"column":43},"end":{"row":445,"column":0},"action":"remove","lines":["",""],"id":6849}],[{"start":{"row":443,"column":0},"end":{"row":443,"column":8},"action":"remove","lines":["    if m"],"id":6850}],[{"start":{"row":442,"column":39},"end":{"row":443,"column":0},"action":"remove","lines":["",""],"id":6851}],[{"start":{"row":443,"column":4},"end":{"row":443,"column":6},"action":"remove","lines":["  "],"id":6852}],[{"start":{"row":449,"column":40},"end":{"row":450,"column":0},"action":"insert","lines":["",""],"id":6853},{"start":{"row":450,"column":0},"end":{"row":450,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":450,"column":4},"end":{"row":451,"column":0},"action":"insert","lines":["",""],"id":6854},{"start":{"row":451,"column":0},"end":{"row":451,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":451,"column":4},"end":{"row":453,"column":7},"action":"insert","lines":["    if object.match(/^F$/)","      object_info[\"flammable\"] = true","    end"],"id":6855}],[{"start":{"row":451,"column":6},"end":{"row":451,"column":8},"action":"remove","lines":["  "],"id":6856}],[{"start":{"row":451,"column":4},"end":{"row":451,"column":6},"action":"remove","lines":["  "],"id":6857}],[{"start":{"row":451,"column":22},"end":{"row":451,"column":23},"action":"remove","lines":["F"],"id":6858},{"start":{"row":451,"column":22},"end":{"row":451,"column":23},"action":"insert","lines":["O"]}],[{"start":{"row":451,"column":26},"end":{"row":452,"column":0},"action":"insert","lines":["",""],"id":6859},{"start":{"row":452,"column":0},"end":{"row":452,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":452,"column":6},"end":{"row":452,"column":7},"action":"insert","lines":["m"],"id":6860}],[{"start":{"row":452,"column":7},"end":{"row":452,"column":8},"action":"insert","lines":[" "],"id":6861}],[{"start":{"row":452,"column":8},"end":{"row":452,"column":9},"action":"insert","lines":["="],"id":6862}],[{"start":{"row":452,"column":9},"end":{"row":452,"column":10},"action":"insert","lines":[" "],"id":6863}],[{"start":{"row":452,"column":10},"end":{"row":452,"column":19},"action":"insert","lines":["^O\\n(.*)~"],"id":6864}],[{"start":{"row":452,"column":6},"end":{"row":452,"column":10},"action":"remove","lines":["m = "],"id":6865},{"start":{"row":452,"column":6},"end":{"row":452,"column":55},"action":"insert","lines":["m = exit_data.match(/^(.*)~\\n(\\d*) (\\d*) (\\d*)$/)"]}],[{"start":{"row":452,"column":55},"end":{"row":452,"column":64},"action":"remove","lines":["^O\\n(.*)~"],"id":6866}],[{"start":{"row":452,"column":27},"end":{"row":452,"column":53},"action":"remove","lines":["^(.*)~\\n(\\d*) (\\d*) (\\d*)$"],"id":6867},{"start":{"row":452,"column":27},"end":{"row":452,"column":36},"action":"insert","lines":["^O\\n(.*)~"]}],[{"start":{"row":453,"column":19},"end":{"row":453,"column":28},"action":"remove","lines":["flammable"],"id":6868},{"start":{"row":453,"column":19},"end":{"row":453,"column":23},"action":"insert","lines":["name"]}],[{"start":{"row":453,"column":28},"end":{"row":453,"column":32},"action":"remove","lines":["true"],"id":6869},{"start":{"row":453,"column":28},"end":{"row":453,"column":38},"action":"insert","lines":["m[1].strip"]}],[{"start":{"row":451,"column":7},"end":{"row":451,"column":13},"action":"remove","lines":["object"],"id":6870},{"start":{"row":451,"column":7},"end":{"row":451,"column":16},"action":"insert","lines":["exit_data"]}],[{"start":{"row":453,"column":6},"end":{"row":453,"column":17},"action":"remove","lines":["object_info"],"id":6871},{"start":{"row":453,"column":6},"end":{"row":453,"column":15},"action":"insert","lines":["exit_info"]}],[{"start":{"row":392,"column":0},"end":{"row":461,"column":3},"action":"remove","lines":["def parse_rooms(rooms_block)","  rooms_info = Hash.new","  i = 1","  ","  rooms = rooms_block.split(\"#\").map(&:strip)","  ","  rooms.each do |room|","    m = room.match(/^(\\d+)\\n(.*)~\\n([^~]*)\\n~\\n(\\d*) ([0-9|]*) (\\d*)/)","    room_info = Hash.new","    room_info[\"vnum\"]        = m[1].to_i","    room_info[\"name\"]        = m[2].strip","    room_info[\"description\"] = m[3].strip","    room_info[\"area_number\"] = m[4].to_i","    room_info[\"room_flags\"]  = read_flags( m[5].strip )","    room_info[\"terrain\"]     = m[6].to_i","    ","    if room.match(/^E$/) # any extra descriptions?","      room_info[\"extra_descs\"] = parse_extra_descs( room.split(/^E$/).map(&:strip) )","    end","    ","    if room.match(/^D\\d$/) # any exits?","      #room_info[\"exits\"] = parse_exits( room.split(/^D$/).map(&:strip) )","      ","      room_info[\"exits\"] = parse_exits( room.match(/^D\\d\\n[^#]*^S$/)[0] ) # Parse from 1st exit to end-of-room","    end","    ","    rooms_info[i] = room_info","    i = i + 1","  end","  ","  return rooms_info","end","","def parse_exits(exits_block)","  exits_block.gsub!(/^D(\\d)$/,'Exit: \\1')","  exits_block.gsub!(/^E\\n^.*~\\n[^~]*~/, '') # remove extra descriptions","  exits_block.gsub!(/^S$/, '') # remove trailing S","  ","  exits_list = exits_block.split(/^Exit: /).map(&:strip)","  exits_list.shift","  ","  exits_info = Hash.new","  i = 1","  ","  exits_list.each do |exit_data|","    exit_info = Hash.new","    ","    m = exit_data.match(/^(\\d)$/)","    exit_info[\"direction\"]   = m[1].to_i","    ","    m = exit_data.match(/\\d\\n([^~]*)~/)","    exit_info[\"description\"] = m[1].strip","  ","    m = exit_data.match(/^(.*)~\\n(\\d*) (\\d*) (\\d*)$/)","    exit_info[\"keywords\"]    = ( m[1].strip == nil ? \"\" : m[1].strip )","    exit_info[\"exittype\"]    = m[2].to_i","    exit_info[\"key_vnum\"]    = m[3].to_i","    exit_info[\"exit_vnum\"]   = m[4].to_i","    ","    if exit_data.match(/^O$/)","      m = exit_data.match(/^O\\n(.*)~/)","      exit_info[\"name\"] = m[1].strip","    end","    ","    exits_info[i] = exit_info","    i = i + 1","  end","  ","  return exits_info","end"],"id":6872}]]},"ace":{"folds":[],"scrolltop":5341,"scrollleft":0,"selection":{"start":{"row":392,"column":0},"end":{"row":392,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":264,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1460864339821,"hash":"317c8c6c51802ea4c6ddd3a6a0f0274eac29040e"}