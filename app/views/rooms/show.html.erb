<%- model_class = Room -%>

<div class="panel panel-default">
    <div class="panel-heading monospace"><h3>
        <%= link_to @area.name, area_path(@area) %> /
        <%= link_to 'Rooms', area_rooms_path(@area) %> /
        Room: <%= @room.vnum %>
    </h3></div>
    <div class="panel-body monospace">

      <div class="row">
        <div class="col-md-2">
          <strong>Formal Vnum:</strong>
        </div>
        <div class="col-md-10">
          <div class="col-md-10">
            <%= @room.formal_vnum %>
          </div>
        </div>
      </div><br/>

      <div class="row">
        <div class="col-md-2">
          <strong><%= model_class.human_attribute_name(:name) %>:</strong>
        </div>
        <div class="col-md-10">
          <div class="col-md-10">
            <%= @room.name %>
          </div>
        </div>
      </div><br/>

      <div class="row">
        <div class="col-md-2">
          <strong><%= model_class.human_attribute_name(:description) %>:</strong>
        </div>
        <div class="col-md-10">
          <div class="col-md-10">
            <%= simple_format(word_wrap(@room.description, line_width: 75)) %>
          </div>
        </div>
      </div><br/>

      <div class="row">
        <div class="col-md-2">
          <strong><%= model_class.human_attribute_name(:room_flags) %> value:</strong>
        </div>
        <div class="col-md-10">
          <div class="col-md-10"><%= @room.room_flags %></div>
        </div>
      </div><br/>
      
      <div class="row">
        <div class="col-md-2">
          <strong><%= model_class.human_attribute_name(:room_flags) %>:</strong>
        </div>
        <div class="col-md-10">
          <% if @room.room_flags == 0 %><div class="col-md-2">NONE</div><% end %>
          <% if @room.dark? %><div class="col-md-2">DARK</div><% end %>
          <% if @room.no_sleep? %><div class="col-md-2">NO SLEEP</div><% end %>
          <% if @room.no_mob? %><div class="col-md-2">NO MOB</div><% end %>
          <% if @room.indoors? %><div class="col-md-2">INDOORS</div><% end %>
          <% if @room.foggy? %><div class="col-md-2">FOGGY</div><% end %>
          <% if @room.private_room? %><div class="col-md-2">PRIVATE</div><% end %>
          <% if @room.peaceful? %><div class="col-md-2">PEACEFUL</div><% end %>
          <% if @room.solitary? %><div class="col-md-2">SOLITARY</div><% end %>
          <% if @room.no_recall? %><div class="col-md-2">NO RECALL</div><% end %>
          <% if @room.no_steal? %><div class="col-md-2">NO STEAL</div><% end %>
          <% if @room.notrans? %><div class="col-md-2">NOTRANS</div><% end %>
          <% if @room.no_spell? %><div class="col-md-2">NO SPELL</div><% end %>
          <% if @room.no_fly? %><div class="col-md-2">NO FLY</div><% end %>
          <% if @room.fly_ok? %><div class="col-md-2">FLY OK</div><% end %>
          <% if @room.no_quest? %><div class="col-md-2">NO QUEST</div><% end %>
          <% if @room.no_item? %><div class="col-md-2">NO ITEM</div><% end %>
          <% if @room.no_vnum? %><div class="col-md-2">NO VNUM</div><% end %>
        </div>
      </div><br/>

      <div class="row">
        <div class="col-md-2">
          <strong><%= model_class.human_attribute_name(:terrain) %> value:</strong>
        </div>
        <div class="col-md-10">
          <div class="col-md-10"><%= @room.terrain %></div>
        </div>
      </div><br/>

      <div class="row">
        <div class="col-md-2">
          <strong><%= model_class.human_attribute_name(:terrain) %>:</strong>
        </div>
        <div class="col-md-10">
          <% if @room.terrain == 0 %><div class="col-md-2">INSIDE</div><% end %>
          <% if @room.terrain == 1 %><div class="col-md-2">CITY</div><% end %>
          <% if @room.terrain == 2 %><div class="col-md-2">FIELD</div><% end %>
          <% if @room.terrain == 3 %><div class="col-md-2">FOREST</div><% end %>
          <% if @room.terrain == 4 %><div class="col-md-2">HILLS</div><% end %>
          <% if @room.terrain == 5 %><div class="col-md-2">MOUNTAIN</div><% end %>
          <% if @room.terrain == 6 %><div class="col-md-2">WATER SWIM</div><% end %>
          <% if @room.terrain == 7 %><div class="col-md-2">WATER NOSWIM</div><% end %>
          <% if @room.terrain == 8 %><div class="col-md-2">UNDERWATER</div><% end %>
          <% if @room.terrain == 9 %><div class="col-md-2">AIR</div><% end %>
          <% if @room.terrain == 10 %><div class="col-md-2">DESERT</div><% end %>
        </div>
      </div><br/>

      <%= render 'rooms/exitmap', :room => @room %>
          
      <div class="row">
        <div class="col-md-2">
          <strong>Exits:</strong>
        </div>
        <div class="col-md-10">
          <div class="col-md-10">
            <table class="table table-hover monospace">
              <thead>
                <tr>
                  <th>Direction</th>
                  <th>Description</th>
                  <th>Keywords</th>
                  <th>Type</th>
                  <th>Key Vnum</th>
                  <th>Exit To</th>
                  <th>Name</th>
                  <th><%=t '.actions', :default => t("helpers.actions") %></th>
                </tr>
              </thead>
              <tfoot><tr><td colspan = '100%'>
                <%= link_to 'New Exit', new_area_room_exit_path(@area, @room), :class => 'btn btn-primary' %>
              </td></tr></tfoot>
              <tbody>
                <% @room.exits.order(:direction).each do |exit| %>
                  <tr>
                    <td><%= exit.direction_word %></td>
                    <td><%= exit.description %></td>
                    <td><%= exit.keywords %></td>
                    <td><%= exit.exittype %><% if not exit.dir_type_combo_ok? %><span style="color:red"> <%= glyph 'exclamation-sign' %></span><% end %></td>
                    <td><%= exit.keyvnum %></td>
                    <td><% if exit.destination_exists? %>
                          <%= link_to exit.exit_room_id, area_room_path(@area, Room.where(["vnum = ?", exit.exit_room_id]).first ) %>
                        <% else %>
                          <span style="color:red"><%= exit.exit_room_id %> <%= glyph 'exclamation-sign' %></span>
                        <% end %>
                    </td>
                    <td><%= exit.name %></td>
                    <td>
                      <%= link_to area_room_exit_path(@area, @room, exit), :class => 'btn btn-xs', :title => "#{ t('.show', :default => t('helpers.links.show')) }" do %>
                        <%= glyph 'info-sign' %>
                      <%- end -%>
                      <%= link_to edit_area_room_exit_path(@area, @room, exit), :class => 'btn btn-xs', :title => "#{ t('.edit', :default => t('helpers.links.edit')) }" do %>
                        <%= glyph 'pencil' %>
                      <%- end -%>
                      <%= link_to area_room_exit_path(@area, @room, exit), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-xs', :title => "#{ t('.destroy', :default => t('helpers.links.destroy')) }" do %>
                        <%= glyph 'remove' %>
                      <%- end -%>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <br/>

      <div class="row">
        <div class="col-md-2">
          <strong>Extra Descriptions:</strong>
        </div>
        <div class="col-md-10">
          <div class="col-md-10">
            <table class="table table-hover monospace">
              <thead>
                <tr>
                  <th>Keywords</th>
                  <th>Description</th>
                  <th><%=t '.actions', :default => t("helpers.actions") %></th>
                </tr>
              </thead>
              <tfoot><tr><td colspan = '100%'>
                <%= link_to 'New Extra Description', new_area_room_rxdesc_path(@area, @room), :class => 'btn btn-primary' %>
              </td></tr></tfoot>
              <tbody>
                <% @room.rxdescs.each do |rxdesc| %>
                  <tr>
                    <td><%= rxdesc.keywords %></td>
                    <td><%= simple_format(truncate(rxdesc.description, length: 220, separator: ' ', omission: '[...]')) %></td>
                    <td>
                      <%= link_to area_room_rxdesc_path(@area, @room, rxdesc), :class => 'btn btn-xs', :title => "#{ t('.show', :default => t('helpers.links.show')) }" do %>
                        <%= glyph 'info-sign' %>
                      <%- end -%>
                      <%= link_to edit_area_room_rxdesc_path(@area, @room, rxdesc), :class => 'btn btn-xs', :title => "#{ t('.edit', :default => t('helpers.links.edit')) }" do %>
                        <%= glyph 'pencil' %>
                      <%- end -%>
                      <%= link_to area_room_rxdesc_path(@area, @room, rxdesc), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) }, :class => 'btn btn-xs', :title => "#{ t('.destroy', :default => t('helpers.links.destroy')) }" do %>
                        <%= glyph 'remove' %>
                      <%- end -%>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <br/>
      
    <strong>Formatted room:</strong>
    <p>
        <pre><%= render 'rooms/roomblock', :room => @room %></pre>
    </p>

    </div>

    <div class="panel-footer form-group">
      <%= link_to t('.back', :default => t("helpers.links.back")),
                  area_rooms_path(@area), :class => 'btn btn-default'  %>
      <%= link_to t('.edit', :default => t("helpers.links.edit")),
                  edit_area_room_path(@area, @room), :class => 'btn btn-default' %>
      <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                  area_room_path(@area, @room),
                  :method => 'delete',
                  :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                  :class => 'btn btn-danger' %>
    </div>
    
</div>
